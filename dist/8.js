webpackJsonp([8],{549:function(e,t,a){a(699);var i=a(200)(a(608),a(745),"data-v-c4b585f8",null);e.exports=i.exports},552:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAqFBMVEX///8AAAAAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneMAneO2iO8PAAAAN3RSTlMAAAyA2/7rnh4g2vE3CdTmEm9+zeVBK8rT+WRX+kBMEFg8LjBKUOHRPzS6446ZGOz2I1Pg7qgsg2bf9AAAAAlwSFlzAAALEwAACxMBAJqcGAAAARZJREFUaN7t2ttOAjEYBOBWjiuoCCqwyMoelIMIeJz3fzNSYuwa6YaEv4lsZm4n2S9NuslcVCmllNZnlWoNwqk3mlqrn+jgXFrYpdXOIReXXgzgqmORa08G0LVID8DNbSCbuz6AgUWGAEItnRGAe4uYg43FkbH5LBEiRIgQIXKiSPQgnegv4ilEjkAm+ydabLrYueCK6gkOvcKB6QLnNS2qD/9PiBAhQoQIkf+HOHZXYrrEua2Kau6uk0C4u4gQIUKECJE8EqZ7k5kuS10pqsMyD4nyIOW5wkSIECFChMixiHkQ9SiOZL+RJwDTmfDumi8APFtk6W1HvFhktfZkbF4tott1L8bwLf9STa+W7+LEx+fX93O4LZIDzN9sNNQJAAAAAElFTkSuQmCC"},554:function(e,t,a){e.exports={default:a(555),__esModule:!0}},555:function(e,t,a){var i=a(60),l=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return l.stringify.apply(l,arguments)}},608:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(554),l=a.n(i),o=a(201);t.default={data:function(){return{form:{name:"",value:""},sqlvalue:"",dbsNameList:[],hidePreTable:!1,dialogSqlTableVisible:!1,dialogSqlTableVisible2:!1,preTable:{list:[],alllist:[]},tabNames:"",activeTabs:"0",columnName:"",columnDataList:[],columnIndex:0,color:"",color2:"",step:1,realcolumn:"",realtables:"",dabeList:[],sqlname:"",button_status:!0}},computed:{},created:function(){this.ajax()},methods:{ajax:function(){var e=this;o.a.get("website/packsql/getTableConn",{},function(t){e.dbsNameList=t})},openWindow:function(){this.dialogSqlTableVisible=!0;var e=this;window.setTimeout(function(){e.dabeList.map(function(t,a){if("1"===t.isJoin)return e.$refs.select_table1.toggleRowSelection(t,!0)})},200)},select:function(e,t){"1"===t.isJoin?t.isJoin="2":t.isJoin="1"},selectedAll:function(e){e.map(function(e){"1"===e.isJoin?e.isJoin="2":e.isJoin="1"})},saveDate:function(){console.log(this.dabeList),console.log(this.form.value),console.log(this.$route.params.id),console.log(this.sqlname);var e=this;if(""==e.sqlname.trim())return this.$message.error("请输入要保存的表名");o.a.post("website/packsql/addsqlBase",{dabeList:l()(e.dabeList),pickid:e.$route.query.id,dbsName:e.form.value,name:e.sqlname},function(t){e.$router.push({path:"/pack/packDetail",query:{id:e.$route.query.id,name:e.$route.query.name}})})},modalColumn:function(e,t){this.columnDataList="",this.step=1,this.color="",this.columnIndex=t,this.realtables="none"===e.relationTables?"":e.relationTables,this.realcolumn=e.relationColumn,e.correspondence&&(this.activeTabs=e.correspondence),this.columnName=e.columnName,this.dialogSqlTableVisible2=!0},cho_item:function(e){this.activeTabs=e},contactTable:function(){var e=this;o.a.post("website/pack/getDataTableByName",{dbsName:this.form.value},function(t){e.columnDataList=t.data.list})},choItem:function(e,t){this.color=t;var a=this;o.a.post("website/pack/getTableColumnByName",{dbsName:this.form.value,classname:e.tabName},function(t){a.columnDataList=t.data.list,a.realtables=e.tabName,a.realcolumn="",a.step=2})},choItem2:function(e,t){this.color2=t,this.realcolumn=e,this.dabeList[this.columnIndex].relationTables=this.realtables,this.dabeList[this.columnIndex].relationColumn=e,this.dabeList[this.columnIndex].correspondence=this.activeTabs,console.log(this.dabeList),this.columnDataList="",this.init()},init:function(){this.columnDataList="",this.step=1,this.color="",this.color2=""},preview:function(){var e=this,t=this,a=this.form.value,i=this.$refs.sqlvalue.innerHTML;if(""==a||""==i)return this.$message.error("请确定数据连接和sql都存在");o.a.post("website/packsql/selectData",{name:a,sql:i},function(a){if(t.button_status=!0,t.preTable.list="",t.preTable.alllist="","true"==a.data.error)return e.$message.error("sql错误");t.hidePreTable=!0,t.preTable.list=a.data.list,t.preTable.alllist=a.data.alllist,a.data.list.map(function(e,a){t.dabeList.push({columnName:e.split("-")[0],columnType:e.split("-")[1],relationTables:"none",isJoin:"1",comments:"",relationColumn:"",correspondence:""})}),t.button_status=!1})}}}},656:function(e,t,a){t=e.exports=a(28)(void 0),t.push([e.i,".page[data-v-c4b585f8]{position:relative}.page .el-row[data-v-c4b585f8]{height:100%;margin-bottom:50px}.page .el-row .col_span[data-v-c4b585f8]{height:100%}.page .el-row .left_con[data-v-c4b585f8]{margin-top:5px;border:1px solid #eee}.page .el-row .left_con .cho_data[data-v-c4b585f8]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:0 20px}.page .el-row .left_con .send_sql[data-v-c4b585f8]{position:relative;clear:both;width:96%;height:400px;margin:20px 2% 0;border:1px solid #ddd}.page .el-row .left_con .send_sql .header[data-v-c4b585f8]{background:#eee;text-align:center;height:30px;line-height:30px}.page .el-row .left_con .contenteditable[data-v-c4b585f8]{height:370px;padding:10px;font-size:16px}.page .el-row .left_con .contenteditable[data-v-c4b585f8]:empty:before{content:attr(placeholder);font-size:16px;color:#999}.page .el-row .left_con .contenteditable[data-v-c4b585f8]:focus:before{content:none}.page .el-row .right_con[data-v-c4b585f8]{margin-top:5px;border:1px solid #eee}.page .el-row .right_con .prebutton[data-v-c4b585f8]{height:60px;text-align:center;line-height:60px;border-bottom:2px solid #eee}.page .el-row .right_con .prebutton .el-button[data-v-c4b585f8]{width:100px;height:30px;background:#ccc;border:none}.page .el-row .right_con .contain[data-v-c4b585f8]{width:94%;height:385px;margin:5px 5% 0 1%;overflow-y:auto}.page .footer[data-v-c4b585f8]{position:absolute;bottom:45px;height:50px;width:100%;border-top:1px solid #eee;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:0 40px 0 10px}.page .footer .el-button[data-v-c4b585f8]{width:100px}.page .footer .el-button span[data-v-c4b585f8]{display:inline-block;line-height:30px;height:30px}h5[data-v-c4b585f8]{height:30px;line-height:30px;padding-left:4px;border-bottom:1px solid #eee;color:#317eac;font-weight:700}.dialogHeader[data-v-c4b585f8]{height:50px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.dialogHeader .title1[data-v-c4b585f8]{color:#317eac;font-weight:700}.dialogFooter[data-v-c4b585f8]{height:50px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.dialogFooter .el-button[data-v-c4b585f8]{margin-left:10px}.pos[data-v-c4b585f8]{position:absolute;top:105px;color:#1f2d3d;font-weight:700;z-index:100;right:70px}.relate_con[data-v-c4b585f8]{width:770px;height:150px;position:relative}.relate_con .box1[data-v-c4b585f8]{position:absolute;border:1px solid #ddd;background:#eee;width:180px;height:90px;top:30px;left:0;overflow:hidden}.relate_con .box .text[data-v-c4b585f8]{width:100%;height:45px;line-height:45px;text-align:center}.relate_con .box .text[data-v-c4b585f8]:first-child{border-bottom:1px solid #ddd}.relate_con .line1[data-v-c4b585f8]{position:absolute;background:#bbb;width:70px;height:1px;top:74.5px;left:180px;overflow:hidden}.relate_con .box2[data-v-c4b585f8]{position:absolute;border:1px solid #ddd;background:#eee;width:140px;height:130px;top:10px;left:250px;overflow:hidden}.relate_con .box2 .item[data-v-c4b585f8]{margin:8px 10px 0;background:#fff;width:120px;text-align:center;height:33px;line-height:33px}.relate_con .box2 .item.active[data-v-c4b585f8]{background:#2fa4e7;color:#fff}.relate_con .line2[data-v-c4b585f8]{position:absolute;background:#bbb;width:70px;height:1px;top:74.5px;left:390px;overflow:hidden}.relate_con .box3[data-v-c4b585f8]{position:absolute;border:1px solid #ddd;background:#eee;width:180px;height:90px;top:30px;left:460px;overflow:hidden}.relate_con .close[data-v-c4b585f8]{position:absolute;width:20px;height:20px;top:65px;right:40px}.relateDabeButton[data-v-c4b585f8]{width:100%;height:40px;text-align:right;padding-right:10px}.relateDabeButton button[data-v-c4b585f8]{width:120px;height:32px;border:none;background:#2fa4e7;color:#fff;border-radius:4px}",""])},699:function(e,t,a){var i=a(656);"string"==typeof i&&(i=[[e.i,i,""]]);a(29)(i,{});i.locals&&(e.exports=i.locals)},745:function(e,t,a){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{staticClass:"col_span",attrs:{span:14}},[i("div",{staticClass:"left_con"},[i("h5",[e._v("SQL数据集配置")]),e._v(" "),i("div",{staticClass:"cho_data"},[i("span",{staticClass:"title1"},[e._v("数据来自数据连接")]),e._v(" "),i("el-select",{staticClass:"select",attrs:{filterable:"",placeholder:"请选择",size:"small"},model:{value:e.form.value,callback:function(t){e.form.value=t},expression:"form.value"}},e._l(e.dbsNameList,function(e,t){return i("el-option",{key:t,attrs:{label:e.dbsName,value:e.dbsName}})}))],1),e._v(" "),i("div",{staticClass:"send_sql"},[i("div",{staticClass:"header"},[e._v("SQL语句")]),e._v(" "),i("div",{ref:"sqlvalue",staticClass:"contenteditable",attrs:{id:"sqldata",contenteditable:"true",placeholder:"请输入SQL"}})])])]),e._v(" "),i("el-col",{staticClass:"col_span",attrs:{span:10}},[i("div",{staticClass:"right_con"},[i("h5",[e._v("表数据")]),e._v(" "),i("div",{staticClass:"prebutton"},[i("el-button",{attrs:{type:"default",size:"small"},on:{click:e.preview}},[e._v("预览")])],1),e._v(" "),i("div",{staticClass:"contain"},[i("div",{staticStyle:{"overflow-x":"auto","overflow-y":"auto",height:"100%",width:"100%"}},[e.hidePreTable?i("table",{staticClass:"table table-bordered",staticStyle:{"table-layout":"fixed","border-collapse":"collapse"}},[i("thead",[i("tr",e._l(e.preTable.list,function(t){return i("th",{staticStyle:{width:"150px","border-bottom-width":"1px"},attrs:{title:t}},[e._v("\n                                    "+e._s(t.split("-")[0])+"\n                                ")])}))]),e._v(" "),i("tbody",e._l(e.preTable.alllist,function(t){return i("tr",e._l(t,function(t){return i("td",[e._v(e._s(t))])}))}))]):e._e()])])])])],1),e._v(" "),i("div",{staticClass:"footer"},[i("el-button",{attrs:{type:"default"}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary",disabled:e.button_status},on:{click:e.openWindow}},[e._v("保存")])],1),e._v(" "),i("el-dialog",{staticClass:"mymodel",attrs:{visible:e.dialogSqlTableVisible,size:"middle","show-close":!1},on:{"update:visible":function(t){e.dialogSqlTableVisible=t}}},[i("div",{staticClass:"dialogHeader"},[i("p",{staticClass:"title"},[e._v("表数据设置")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){}}},[e._v("表预览")])],1),e._v(" "),i("div",{staticStyle:{"margin-bottom":"10px"}},[i("el-input",{staticStyle:{border:"1px solid #bfcbd9"},attrs:{placeholder:"请输入"},model:{value:e.sqlname,callback:function(t){e.sqlname=t},expression:"sqlname"}})],1),e._v(" "),i("div",{staticClass:"pos"},[e._v("参与分析")]),e._v(" "),i("el-table",{ref:"select_table1",attrs:{data:e.dabeList,border:"","max-height":250,"row-key":"columnName"},on:{"select-all":e.selectedAll,select:e.select}},[i("el-table-column",{attrs:{label:"原字段名",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("p",{on:{click:function(a){e.modalColumn(t.row,t.$index)}}},[e._v(e._s(t.row.columnName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{property:"columnType",label:"类型",width:"150"}}),e._v(" "),i("el-table-column",{attrs:{label:"转义名",width:"100"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-input",{staticClass:"noBorderInput",attrs:{size:"small"},model:{value:e.row.comments,callback:function(t){e.row.comments=t},expression:"scope.row.comments"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"关联表",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{title:t.row.relationTables}},[e._v(e._s("none"===t.row.relationTables?"":t.row.relationTables))])]}}])}),e._v(" "),i("el-table-column",{attrs:{type:"selection",width:"150","header-align":"left",align:"center","reserve-selection":!0}})],1),e._v(" "),i("div",{staticClass:"dialogFooter"},[i("el-button",{attrs:{type:"default",size:"small"},on:{click:function(t){e.dialogSqlTableVisible=!1}}},[e._v("关闭")]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.saveDate}},[e._v("保存")])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogSqlTableVisible2,size:"middle",title:"表预览"},on:{"update:visible":function(t){e.dialogSqlTableVisible2=t}}},[i("div",{staticClass:"relate_con"},[i("div",{staticClass:"box box1"},[i("div",{staticClass:"text",attrs:{id:"texttable"}},[e._v(e._s(e.tabNames))]),e._v(" "),i("div",{staticClass:"text",attrs:{id:"textid"}},[e._v(e._s(e.columnName))])]),e._v(" "),i("div",{staticClass:"box2"},[i("div",{class:"0"===e.activeTabs?"item active":"item",on:{click:function(t){e.cho_item("0")}}},[e._v("1:1")]),e._v(" "),i("div",{class:"1"===e.activeTabs?"item active":"item",on:{click:function(t){e.cho_item("1")}}},[e._v("1:N")]),e._v(" "),i("div",{class:"2"===e.activeTabs?"item active":"item",on:{click:function(t){e.cho_item("2")}}},[e._v("N:1")])]),e._v(" "),i("div",{staticClass:"box box3"},[i("div",{staticClass:"text",attrs:{id:"oppositetable"}},[e._v(e._s(e.realtables))]),e._v(" "),i("div",{staticClass:"text",attrs:{id:"oppositeid"}},[e._v(e._s(e.realcolumn))])]),e._v(" "),i("div",{staticClass:"line1"}),e._v(" "),i("div",{staticClass:"line2"}),e._v(" "),i("div",{staticClass:"close",on:{click:function(e){}}},[e._v("×")])]),e._v(" "),i("div",{staticClass:"relateDabeButton"},[i("el-button",{attrs:{type:"primary"},on:{click:e.contactTable}},[e._v("+ 关联到其他表")])],1),e._v(" "),1===e.step?i("div",{staticClass:"tablist"},e._l(e.columnDataList,function(t,l){return i("span",{key:l,class:e.color===l?"span active":"span",on:{click:function(a){e.choItem(t,l)}}},[i("img",{attrs:{src:a(552),alt:""}}),e._v("\n            "+e._s(t.tabName)+"\n        ")])})):e._e(),e._v(" "),2===e.step?i("div",{staticClass:"tablist"},e._l(e.columnDataList,function(t,l){return i("span",{key:l,class:e.color2===l?"span active":"span",on:{click:function(a){e.choItem2(t,l)}}},[i("img",{attrs:{src:a(552),alt:""}}),e._v("\n            "+e._s(t)+"\n        ")])})):e._e()])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=8.js.map?0460829047f96aaa0346